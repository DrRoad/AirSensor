<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>An Introduction to PurpleAir Time Series Data • AirSensor</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="An Introduction to PurpleAir Time Series Data">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">AirSensor</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/pas_introduction.html">An Introduction to PurpleAir Synoptic Data</a>
    </li>
    <li>
      <a href="../articles/pat_introduction.html">An Introduction to PurpleAir Time Series Data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/MazamaScience/AirSensor">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>An Introduction to PurpleAir Time Series Data</h1>
                        <h4 class="author">Mazama Science</h4>
            
            <h4 class="date">2019-04-11</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/MazamaScience/AirSensor/blob/master/vignettes/pat_introduction.Rmd"><code>vignettes/pat_introduction.Rmd</code></a></small>
      <div class="hidden name"><code>pat_introduction.Rmd</code></div>

    </div>

    
    
<p><em>Time series</em> data provides a minute-by-minute database structure for transforming and analyzing <a href="https://www.purpleair.com/">PurpleAir</a> sensor data. This vignette demonstrates an example analysis of an individual monitor located in Seattle, Washington over a two-month duration in which the Pacific Northwest experienced <a href="https://www.usnews.com/news/healthiest-communities/articles/2018-08-19/air-quality-to-worsen-in-northwest-as-smoke-returns">hazardous air-quality conditions</a> caused by wildfires in British Columbia, Canada.</p>
<p><strong>Disclaimer:</strong> It is highly recommended that you read <code>vignettes/pas_introduction.Rmd</code> before beginning this tutorial.</p>
<div id="loading-purpleair-time-series-data" class="section level3">
<h3 class="hasAnchor">
<a href="#loading-purpleair-time-series-data" class="anchor"></a>Loading PurpleAir Time Series data</h3>
<p>PurpleAir sensor readings are uploaded to the cloud every 80 seconds or so where they are stored for download and display on the PurpleAir website. After every interval, the synoptic data is refreshed and the outdated synoptic data is then stored in a <a href="https://thingspeak.com">ThingSpeak</a> database. In order to access the ThingSpeak channel API we must first load the synoptic database, which provides access tokens for each PurpleAir sensor – accessed by the monitor of interests label.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(AirSensor)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(MazamaCoreUtils)
pas &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pas_load.html">pas_load</a></span>()
pat &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pat_load.html">pat_load</a></span>(pas, <span class="st">"Seattle"</span>, <span class="dt">startdate =</span> <span class="dv">20180701</span>, <span class="dt">enddate =</span> <span class="dv">20180901</span>)</code></pre></div>
<p>Notice when passing our synoptic dataframe “<code>pas</code>” to <code>pat_load</code>, we also supply a unique identification label and date-interval. In this case, our monitor-of-interest (MOI) is a sensor named “Seattle” and our dates-of-interest (DOI) is 2018-07-01 to 2018-09-01.</p>
<p><strong>Note:</strong> You must provide a label to <code>pat_load</code> in order to supply ThingSpeak with the necessary metadata to access the sensors database. A DOI on the other hand is optional; by default not providing <code>pat_load</code> with a start and end date will return exactly 1-week of time series data.</p>
</div>
<div id="purpleair-time-series-data" class="section level3">
<h3 class="hasAnchor">
<a href="#purpleair-time-series-data" class="anchor"></a>PurpleAir Time Series Data</h3>
<p>Let’s begin by exploring the attributes of the dataframe returned by the <code>pat_load</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pat <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>()</code></pre></div>
<pre><code>## [1] "meta" "data"</code></pre>
<p><code>pat</code> contains <em>two</em> tables, <code>meta</code> and <code>data</code>.</p>
<p>By convention <code>meta</code> contains metadata of the selected PurpleAir sensor – this includes non-time series data such as location information, labels, etc. The time series <code>data</code> contains time-interval PurpleAir sensor readings of PM2.5, temperature, humidity, and other pertinent sensor data.</p>
<p>We’ll start by plotting PurpleAir’s raw sensor data. We can quickly display the time series data by using <code>pat_multiplot</code> and passing in our raw <code>pat</code> and desired plot type (“<code>all</code>” sensor data).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pat <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="../reference/pat_multiplot.html">pat_multiplot</a></span>(<span class="dt">plottype =</span> <span class="st">"all"</span>)</code></pre></div>
<p><img src="pat_introduction_files/figure-html/allPlot-1.png" width="768"></p>
</div>
<div id="exploring-time-series-data" class="section level3">
<h3 class="hasAnchor">
<a href="#exploring-time-series-data" class="anchor"></a>Exploring Time Series Data</h3>
<p>From the overview plot above, we can gain a general picture of what local <code>"Seattle"</code> atmospheric conditions are like. To take a closer look at PM2.5, we can pass a more specific parameter into <code>pat_multiplot</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pat <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="../reference/pat_multiplot.html">pat_multiplot</a></span>(<span class="dt">plottype =</span> <span class="st">"pm25"</span>)</code></pre></div>
<p><img src="pat_introduction_files/figure-html/pm25Plot-1.png" width="768"></p>
<p>Our <code>pat</code> dataframe spans two months. While this provides a great overview of PM2.5, it is unwieldy to analyze if we are only interested in anomolous air quality. We can use <code>pat_filterDate</code> to subset our <code>pat</code> dates. In this case, we’ll reduce our DOI to 01 August 2018 - 01 September 2018.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pat_august &lt;-<span class="st"> </span>
<span class="st">  </span>pat <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/pat_filterDate.html">pat_filterDate</a></span>(<span class="dt">startdate =</span> <span class="dv">20180801</span>, <span class="dt">enddate =</span> <span class="dv">20180901</span>)

pat_august <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="../reference/pat_multiplot.html">pat_multiplot</a></span>(<span class="dt">plottype =</span> <span class="st">"pm25"</span>)</code></pre></div>
<p><img src="pat_introduction_files/figure-html/augustPlot-1.png" width="768"></p>
<p>Our reduced dataframe <code>pat_august</code> may be a smaller time interval but intermintent sensor errors still likely exist. In order to identify and remove PM2.5 outliers we can use <code><a href="../reference/pat_outliers.html">pat_outliers()</a></code>. We’d also like to display the outliers to compare. Each outlier will be marked with a red “*“. We can assign the filtered dataframe a name for future use.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pat_august_filtered &lt;-<span class="st"> </span>
<span class="st">  </span>pat_august <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="../reference/pat_outliers.html">pat_outliers</a></span>(<span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">showPlot =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p><img src="pat_introduction_files/figure-html/outlierPlot-1.png" width="768"></p>
<p>Now that we have a filtered dataset we can begin looking into smaller datasets. 14 August 2018 appears to be the initial PM2.5 event. We can view a single day using <code>pat_filterDate</code> and <code>pat_multiplot</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">august_<span class="dv">14</span> &lt;-<span class="st"> </span>
<span class="st">  </span>pat_august <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/pat_filterDate.html">pat_filterDate</a></span>(<span class="dt">startdate =</span> <span class="dv">20180814</span>, <span class="dt">days =</span> <span class="dv">1</span>)

august_<span class="dv">14</span> <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/pat_multiplot.html">pat_multiplot</a></span>(<span class="dt">plottype =</span> <span class="st">"all"</span>)</code></pre></div>
<p><img src="pat_introduction_files/figure-html/unnamed-chunk-2-1.png" width="768"></p>
<p>At this resolution we can see our PurpleAir Channel A &amp; B data align closely. We can also confirm see that humidity and temperature have an inverse relationship!</p>
<p>This tutorials is in no way meant to be exhaustive – rather, it is to provide a brief overview of what time series data is, and how it can be used as insightful tool. PurpleAir time series datasets can be large and intimidating. But with a few simple functions we can view PurpleAir sensors with ease. See our other articles to explore deeper PurpleAir functionality.</p>
<p><em>Mazama Science</em></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Jonathan Callahan, Tate Brasel, Hans Martin, Helen Miller.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
